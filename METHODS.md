\# Methods Appendix: Single-Nucleus RNA-seq Workflows



\## Overview

This document describes the analytical workflows used for processing,

quality control, integration, annotation, and downstream analysis of

single-nucleus RNA-sequencing (snRNA-seq) data.



The methods are written to emphasize reproducibility, analytical

rationale, and transparency rather than to serve as a turnkey software

package.



---



\## 1. Preprocessing and Ambient RNA Removal



Raw snRNA-seq outputs generated by Cell Ranger were processed using

CellBender to reduce ambient RNA contamination. Posterior-filtered

count matrices were extracted and converted into Seurat objects for

downstream analysis.



No cell-level filtering was applied at this stage to avoid premature

exclusion of biologically relevant nuclei.



---



\## 2. Quality Control and Doublet Detection



Doublet detection was performed using score-based methods. Doublet

scores were incorporated into cell metadata, and cells exceeding

conservative doublet thresholds were removed prior to integration.



Mitochondrial read percentage was not used as a primary filtering

criterion due to the nuclear origin of the data.



---



\## 3. Data Integration and Batch Correction



To integrate multiple snRNA-seq datasets, variable features were

identified per dataset and data were scaled using variable genes only.

Batch correction was performed using Harmony, and the number of

principal components was selected based on cumulative variance

explained.



Harmony was chosen for its robustness across multi-batch snRNA-seq

datasets and its compatibility with Seurat-based workflows.



---



\## 4. Cluster Identification and Annotation



Clusters were identified in the integrated embedding and annotated

based on canonical marker genes. Marker identification was performed

per cluster, and annotations were assigned conservatively when marker

expression was ambiguous.



Cell-type labels reflect biological interpretation and may evolve with

additional validation or datasets.



---



\## 5. Pseudobulk Differential Expression Analysis



To assess transcriptional differences at the sample or condition

level, pseudobulk expression matrices were constructed by aggregating

counts across cells within defined groups.



Differential expression analysis was performed on pseudobulked data to

improve statistical robustness and reduce single-cell noise.



This analysis was conducted both globally and in a cell-type–specific

manner.



---



\## 6. Visualization of Cellular and Transcriptional Structure



Dimensionality reduction embeddings were visualized to assess cellular

structure and cluster relationships. UMAP visualizations were generated

for specific cell populations, including hepatocyte subclusters, to

facilitate focused biological interpretation.



Heatmaps were used to visualize pseudobulk differential expression

patterns across conditions and cell types.



Cell-type composition analyses were performed to quantify proportional

differences across samples or conditions.



---



\## 7. Pathway-Level Analyses



Pathway enrichment analyses were conducted to interpret transcriptional

changes at the pathway level.



Gene set enrichment analysis (GSEA) was applied to ranked gene lists

derived from pseudobulk differential expression results. Over-

representation analysis (ORA) was performed on selected gene sets to

identify significantly enriched biological pathways.



Additionally, pathway–gene network analyses were used to visualize

relationships between enriched pathways and contributing genes.



---



\## 8. Latent Space Modeling with scVI



To explore transcriptional structure beyond linear embeddings, latent

space modeling was performed using scVI. This approach enables

probabilistic modeling of gene expression while accounting for

technical variability.



Latent representations were used for exploratory analyses and to

complement traditional integration and visualization approaches.



---



\## Notes on Reproducibility



Scripts reflect real analysis pipelines and may require adaptation for

specific datasets, computing environments, or cluster configurations.

Raw sequencing data and sensitive metadata are intentionally excluded.



